{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://semantic-kernel-app/.config/schemas/config.schema.json",
  "title": "Configuration Schema",
  "description": "Master schema for YAML configuration files",
  "type": "object",
  "properties": {
    "metadata": {
      "$ref": "definitions/metadata.schema.json"
    },
    "version": { "type": "string" },
    "category": { "type": "string" },
    "keywords": { "type": "array", "items": { "type": "string" } },
    "updated": { "type": "string" },
    "description": { "type": "string" },
    "cross_references": { "type": "array", "items": { "type": "string" } },
    "related_documentation": { "type": "array", "items": { "type": "string" } },

    "test_template": {
      "type": "object",
      "properties": {
        "timeout": { "type": ["integer", "null"] },
        "requires_services": { "type": "boolean" },
        "enabled": { "type": "boolean" }
      }
    },
    "docker": {
      "type": "object",
      "properties": {
        "startup_wait": { "type": "integer" },
        "health_checks": {
          "type": "object",
          "properties": {
            "interval": { "type": "integer" },
            "timeout": { "type": "integer" },
            "retries": { "type": "integer" }
          }
        }
      }
    },
    "rules": {
      "$ref": "definitions/rules.schema.json"
    },

    "build": {
      "type": "object",
      "properties": {
        "solution": { "type": "string" },
        "configuration": { "type": "string" },
        "verbosity": { "type": "string" }
      }
    },
    "tests": {
      "type": "object",
      "patternProperties": {
        "^[a-zA-Z0-9_-]+$": {
          "type": "object",
          "properties": {
            "timeout": { "type": ["integer", "null"] },
            "requires_services": { "type": "boolean" },
            "enabled": { "type": "boolean" },
            "browsers": { "type": "array", "items": { "type": "string" } }
          }
        }
      }
    },
    "lint": {
      "type": "object",
      "properties": {
        "continue_on_error": { "type": "boolean" },
        "python": { "type": "boolean" },
        "frontend": { "type": "boolean" },
        "sql": { "type": "boolean" },
        "shell": { "type": "boolean" }
      }
    },
    "reporting": {
      "type": "object",
      "properties": {
        "retention_days": { "type": "integer" },
        "format": { "type": "string" }
      }
    },

    "categories": {
      "type": "object",
      "patternProperties": {
        "^[a-zA-Z0-9_-]+$": { "$ref": "definitions/toggles.schema.json#/definitions/category" }
      }
    },
    "profiles": {
      "type": "object",
      "patternProperties": {
        "^[a-zA-Z0-9_-]+$": { "$ref": "definitions/toggles.schema.json#/definitions/profile" }
      }
    },
    "subagent_tasks": {
      "type": "object",
      "patternProperties": {
        "^[a-zA-Z0-9_-]+$": {
          "type": "object",
          "properties": {
            "description": { "type": "string" },
            "parallel_calls": { "type": "array", "items": { "type": "string" } },
            "context_required": { "type": "boolean" }
          },
          "required": ["description", "parallel_calls"]
        }
      }
    },
    "execution_profiles": {
      "type": "object",
      "patternProperties": {
        "^[a-zA-Z0-9_-]+$": {
          "type": "object",
          "properties": {
            "tasks": { "type": "array", "items": { "type": "string" } },
            "max_parallel": { "type": "integer" },
            "timeout_seconds": { "type": "integer" }
          },
          "required": ["tasks"]
        }
      }
    },
    "env_template": { "type": "string" },
    "quick_reference": { "type": "object" },

    "wsl_memory_limit": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "wsl_processor_limit": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "wsl_swap_size": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "localhost_forwarding": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "docker_build_cache_cleanup": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "docker_prune_on_startup": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "registry_enabled": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "buildkit_enabled": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "gpu_enabled": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "mixed_precision": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "flash_attention": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "tf32_enabled": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "memory_pool": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "dynamic_batching": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "async_execution": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "stream_responses": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "connection_pooling": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "aggressive_gc": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "memory_efficient_attention": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "expandable_segments": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "embedding_cache": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "completion_cache": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },
    "memory_cache": { "$ref": "definitions/toggles.schema.json#/definitions/toggle" },

    "gpu": {
      "description": "GPU Configuration or Report Data",
      "oneOf": [
        { "$ref": "definitions/gpu.schema.json#/definitions/gpu_config" },
        { "$ref": "definitions/gpu.schema.json#/definitions/gpu_report" }
      ]
    },

    "service": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean" },
        "port": { "type": "integer" },
        "resources": { "$ref": "definitions/resources.schema.json" },
        "gpu_enabled": { "type": "boolean" }
      }
    },
    "semantic_kernel": {
      "type": "object",
      "additionalProperties": true
    },
    "python_environment": {
      "type": "object",
      "additionalProperties": true
    }
  }
}
