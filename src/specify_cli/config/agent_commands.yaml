_definitions:
  scripts:
    check_prereqs: &check_prereqs
      sh: scripts/bash/check-implementation-prerequisites.sh --json
      ps: scripts/powershell/check-implementation-prerequisites.ps1 -Json
    check_tasks: &check_tasks
      sh: scripts/bash/check-task-prerequisites.sh --json
      ps: scripts/powershell/check-task-prerequisites.ps1 -Json
    check_spec: &check_spec
      sh: scripts/bash/check-spec-prerequisites.sh --json
      ps: scripts/powershell/check-spec-prerequisites.ps1 -Json

analyze:
  description: Perform a non-destructive cross-artifact consistency and quality analysis across spec.md, plan.md, and tasks.md after task generation.
  validation:
    args:
      type: "object"
      properties:
        json: { type: "boolean" }
  scripts: *check_prereqs

checklist:
  description: Generate a custom checklist for the current feature based on user requirements.
  scripts: *check_tasks

clarify:
  description: Identify underspecified areas in the current feature spec by asking up to 5 highly targeted clarification questions and encoding answers back into the spec.
  subagents:
    researcher:
      role: "Researcher"
      goal: "Find missing context"
  handoffs:
    - label: Build Technical Plan
      agent: speckit.plan
      prompt: Create a plan for the spec. I am building with...
      data_transfer:
        format: "markdown"
        artifacts: ["spec.md"]
  scripts: *check_spec

constitution:
  description: Create or update the project constitution from interactive or provided principle inputs, ensuring all dependent templates stay in sync.
  handoffs:
    - label: Build Specification
      agent: speckit.specify
      prompt: Implement the feature specification based on the updated constitution. I want to build...

implement:
  description: Execute the implementation plan by processing and executing all tasks defined in tasks.md
  requirements:
    internet: true
    write_access: true
  scripts: *check_prereqs

plan:
  description: Execute the implementation planning workflow using the plan template to generate design artifacts.
  handoffs:
    - label: Create Tasks
      agent: speckit.tasks
      prompt: Break the plan into tasks
      send: true
    - label: Create Checklist
      agent: speckit.checklist
      prompt: Create a checklist for the following domain...
  scripts:
    sh: scripts/bash/setup-plan.sh --json
    ps: scripts/powershell/setup-plan.ps1 -Json
  agent_scripts:
    sh: scripts/bash/update-agent-context.sh __AGENT__
    ps: scripts/powershell/update-agent-context.ps1 -AgentType __AGENT__

specify:
  description: Create or update the feature specification from a natural language feature description.
  handoffs:
    - label: Build Technical Plan
      agent: speckit.plan
      prompt: Create a plan for the spec. I am building with...
    - label: Clarify Spec Requirements
      agent: speckit.clarify
      prompt: Clarify specification requirements
      send: true
  scripts:
    sh: scripts/bash/create-new-feature.sh --json "{ARGS}"
    ps: scripts/powershell/create-new-feature.ps1 -Json "{ARGS}"

tasks:
  description: Generate an actionable, dependency-ordered tasks.md for the feature based on available design artifacts.
  handoffs:
    - label: Analyze For Consistency
      agent: speckit.analyze
      prompt: Run a project analysis for consistency
      send: true
    - label: Implement Project
      agent: speckit.implement
      prompt: Start the implementation in phases
      send: true
  scripts: *check_tasks

taskstoissues:
  description: Convert existing tasks into actionable, dependency-ordered GitHub issues for the feature based on available design artifacts.
  tools: ["github/github-mcp-server/issue_write"]
  scripts: *check_prereqs
